# javascript-attendance-precourse

## 요구사항

### 출석 시스템 규칙

- 출석 시스템의 출석 확인은 크루가 캠퍼스에 들어온 후 시스템에 출석 데이터가 저장된 시간을 기준으로 한다.
- 시간은 24시간 형식만 사용한다. 예를 들어, "22:30"은 오후 10시 30분을 의미한다.
- 교육 시간은 월요일은 13:0018:00, 화요일금요일은 10:00~18:00이다.
- 해당 요일의 시작 시각으로부터 5분 초과는 지각으로 간주한다.
- 해당 요일의 시작 시각으로부터 30분 초과는 결석으로 간주한다.
- 등교하지 않아 출석 기록이 없는 날은 결석으로 간주한다.
- 누적 지각 및 결석 횟수에 따라 경고 또는 면담을 시행한다. 또한 결석 횟수가 5회를 초과할 때 제적을 시행한다.
- 지각 3회는 결석 1회로 간주한다.
  - 경고 대상자: 결석 2회 이상
  - 면담 대상자: 결석 3회 이상
  - 제적 대상자: 결석 5회 초과
- 캠퍼스 운영 시간은 매일 08:00~23:00이다.
- 주말 및 공휴일에는 출석을 받지 않는다.
- 출석 시스템에 등록된 크루와 12월 출석 기록은 제공된 파일(attendances.csv)에서 확인할 수 있다.

### 출석 확인

- 닉네임과 등교 시간 입력하면 출석
- 출석 후 출석 기록 확인 가능
- 이미 출석했다면 수정 기능 안내

### 출석 수정

- 출석 확인에서 수정으로 이동되었을 때
- 닉네임, 수정하려는 날짜, 등교 시간 입력하여 수정
- 수정 후에는 변경 전, 후 기록 확인 가능

### 크루별 출석 기록 확인

- 닉네임 입력하면 전날까지의 기록 출력

### 제적 위험자 확인

- 전날까지의 출석 기록을 바탕으로 제적 위험자 파악
- 제적 대상자, 면담 대상자, 경고 대상자 순으로 출력
- 정렬 순서는 지각을 결석으로 간주하여 내림차순(횟수가 같다면 결석 순, 아예 상태 같다면 닉네임 오름차순)

### 실행 결과 예시

```
오늘은 12월 13일 금요일입니다. 기능을 선택해 주세요.
1. 출석 확인
2. 출석 수정
3. 크루별 출석 기록 확인
4. 제적 위험자 확인
Q. 종료
1

닉네임을 입력해 주세요.
이든
등교 시간을 입력해 주세요.
09:59

12월 13일 금요일 09:59 (출석)

오늘은 12월 13일 금요일입니다. 기능을 선택해 주세요.
1. 출석 확인
2. 출석 수정
3. 크루별 출석 기록 확인
4. 제적 위험자 확인
Q. 종료
2

출석을 수정하려는 크루의 닉네임을 입력해 주세요.
빙티
수정하려는 날짜(일)를 입력해 주세요.
3
언제로 변경하겠습니까?
09:58

12월 03일 화요일 10:07 (지각) -> 09:58 (출석) 수정 완료!

오늘은 12월 13일 금요일입니다. 기능을 선택해 주세요.
1. 출석 확인
2. 출석 수정
3. 크루별 출석 기록 확인
4. 제적 위험자 확인
Q. 종료
3

닉네임을 입력해 주세요.
빙티

이번 달 빙티의 출석 기록입니다.

12월 02일 월요일 13:00 (출석)
12월 03일 화요일 09:58 (출석)
12월 04일 수요일 10:02 (출석)
12월 05일 목요일 10:06 (지각)
12월 06일 금요일 10:01 (출석)
12월 09일 월요일 --:-- (결석)
12월 10일 화요일 10:08 (지각)
12월 11일 수요일 --:-- (결석)
12월 12일 목요일 --:-- (결석)

출석: 4회
지각: 2회
결석: 3회

면담 대상자입니다.

오늘은 12월 13일 금요일입니다. 기능을 선택해 주세요.
1. 출석 확인
2. 출석 수정
3. 크루별 출석 기록 확인
4. 제적 위험자 확인
Q. 종료
4

제적 위험자 조회 결과
- 빙티: 결석 3회, 지각 2회 (면담)
- 이든: 결석 2회, 지각 4회 (면담)
- 쿠키: 결석 2회, 지각 2회 (경고)
- 빙봉: 결석 1회, 지각 5회 (경고)

오늘은 12월 13일 금요일입니다. 기능을 선택해 주세요.
1. 출석 확인
2. 출석 수정
3. 크루별 출석 기록 확인
4. 제적 위험자 확인
Q. 종료
Q
```

## 설계

설계에 앞서 전체적인 프로그램 흐름을 정리하면

1. 기존 출석 데이터 처리
2. command 입력(반복)
3. 출석확인 -> 닉네임 입력 -> 등교 시간 입력 -> 처리
4. 출석 수정 -> 닉네임 입력 -> 날짜 입력 -> 변경 시간 입력 -> 처리
5. 크루별 확인 -> 닉네임 입력 -> 처리
6. 제적 위험자 -> 처리
7. 결과 출력

이렇게 정리할 수 있다. 가장 먼저 Crew에 대한 정보를 정리하였다. Crew가 가질 정보는

- 출석기록(날짜, 시간, 분으로 이루어진 객체 배열)
- 지각기록(날짜 배열)
- 결석기록(날짜 배열)
- 정상출석기록(날짜 배열)

다음 가장 중요한 Controller의 내부 작업 과정은 다음과 같다.

1. 현재 날쨔를 바탕으로 기존 출석처리(Crew 객체 생성)
2. Command입력 반복 -> 해당 command에 맞는 메서드 진행
3. 출석 확인 -> 닉네임, 등교시간 입력 -> 검증 및 filter -> filter된 데이터 핸들러 전달
4. 출석 수정 -> 닉네임, 날짜 입력 -> 검증 및 filter -> 변경 시간 입력 -> 입력 구조 검증 -> filter된 데이터(크루 객체)와 변경 시간 핸들러 전달
5. 크루별 확인 -> 닉네임 입력 -> 검증 및 filter -> 해당되는 크루 출석 내용으로 결과 생성
6. 제적위험자 -> 핸들러 실행(모든 crewInfo 전달)
7. 결과 받아서 출력

또한 외부에 유틸함수로

- 파서(CSV를 객체로 변경, nickname 배열 생성)
- 지각 여부 확인
- 주말 여부 확인
- 출석 결과 가공
- 수정 결과 가공

을 둬서 사용할 수 있게끔 하기로 하였다.

### CrewService

CrewService는 crew의 정보들을 담은 CrewInfo를 가지고 필요한 정보들을 filter할 수 있게끔, 그리고 그 filter된 데이터를 바탕으로 검증(예를들어 데이터가 없는데 수정하려고 하면 에러 처리) 할 수 있게끔 하는 class다

- 닉네임 입력하여 데이터 있는지 확인 -> 데이터 return
- 닉네임, 날짜 입력하여 데이터 있는지 확인 -> 데이터 return

### Validator

input의 내용을 검증하기 위해 만들었지만, 만약 입력한 내용이 적절하지 않거나 형식과 다르다면 data를 필터링할 때 걸러지게 되기 때문에, 사실상 필요한 부분은 시간 입력, command 입력 뿐일 것이라고 예상하고 있다.

- 시간 형식 확인(split(' : '))
- command 확인(리스트에 있는지)

### DataLauncher

- 초반 프로그램 실행 시 crewInfo 세팅을 위해 만들어진 클래스다.
- 파일 읽어서 받아온 결과를 객체로 파싱, 닉네임 목록 받아옴(외부 유틸함수 사용)
- 객체파싱한 결과를 바탕으로 CrewMaker 생성
- 각 닉네임을 돌며 CrewMaker 메인 로직 실행

### CrewMaker

- 해당 crew의 출석 정보 filter
- crew 객체 만듦
- 오늘 날짜까지 for문으로 돌림
- 주말이면 패스
- 평일인데 출석 정보 없으면 crew 내부에 출석 정보 추가하는 로직에 time null minute null로 정보 전달
- 평일인데 출석 정보 있으면 crew 내부 출석 정보 추가 로직에 날짜, time, minute 전달

### Crew

- 크루 내부에 기존에 만들어둔 데이터들을 두고
- 출석 정보 add하는 로직 만든다.
- 외부 유틸함수 사용 -> 지각, 결석, 출석 여부 확인 후 맞는 arr에 날짜 push
- reset 로직 -> 해당 날짜에 해당되는 정보 삭제 후 지각여부 확인 -> 해당 arr에 있는 날짜 정보 제거

## 구현 체크리스트

### Controller

- [x] 기존 출석 데이터 받아옴
- [x] DataLauncher 실행 -> crewInfo 저장
- [ ] CrewService 생성 및 저장
- [x] 닉네임 받아옴 -> 저장
- [ ] command 입력 반복 처리
  - [ ] command 별로 추가 입력 및 처리
- [ ] 출석 확인 -> 닉네임, 등교시간 입력 -> 검증 및 filter -> attendHandler
- [ ] 출석 수정 -> 닉네임, 날짜 입력 -> 검증 및 filter -> modifyHandler
- [ ] record -> 닉네임 입력 -> 검증 및 filter -> return
- [ ] 제적 위험자 -> riskHandler 실행(crewInfo 전달)
- [ ] 결과 받아서 출력

### DataLauncher

- [ ] nickname 돌며 메인 로직 실행
- [ ] 해당 crew의 출석 정보 filter
- [ ] crew 객체 만듦
- [ ] 오늘날짜까지의 평일 배열 받아옴
- [ ] 배열 돌며 출석 정보 없으면 {date: 날짜, time: null, minute:null, result: '결석'}로 출석 정보 추가 요청
- [ ] 있으면 지각/결석 확인 후 result:에 넣어서 추가 요청

### Crew

- [ ] 출석기록 만듦
- [ ] 출석 추가 로직 생성
  - [ ] 지각/결석/출석 확인(외부 유틸함수)
  - [ ] 출석기록에 추가

### utils

- [x] parseCSV (객체로 변환)
- [ ] parseWorkday(해당 월의 오늘날짜까지 평일 배열 만들기)
- [x] nickname 배열 생성
- [ ] 지각 여부 확인
- [ ] 주말 여부 확인
- [ ] 출석 결과 가공
- [ ] 수정 결과 가공

## 구현

## 소감
